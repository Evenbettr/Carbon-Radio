<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carbon Radio</title>
  <meta name="description" content="Carbon Radio — live transmission for focus and late nights." />

  <style>
    :root{
      --bg0:#05060d;
      --bg1:#0b1030;
      --ink:#e9ecff;
      --muted:#b7bce6;
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --glow: rgba(140,115,255,.35);
      --accent:#8c73ff;
      --accent2:#2de2e6;
      --radius: 18px;
      --shadow: 0 18px 70px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      color:var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(140,115,255,.18), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(45,226,230,.12), transparent 55%),
        radial-gradient(900px 700px at 50% 80%, rgba(255,100,200,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      min-height:100vh;
      overflow-x:hidden;
    }
    .stars:before, .stars:after{
      content:"";
      position:fixed;
      inset:-50%;
      background-image:
        radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.9) 50%, transparent 55%),
        radial-gradient(1px 1px at 80% 30%, rgba(255,255,255,.7) 50%, transparent 55%),
        radial-gradient(1px 1px at 40% 70%, rgba(255,255,255,.6) 50%, transparent 55%),
        radial-gradient(1px 1px at 60% 50%, rgba(255,255,255,.8) 50%, transparent 55%),
        radial-gradient(1px 1px at 25% 85%, rgba(255,255,255,.5) 50%, transparent 55%),
        radial-gradient(2px 2px at 70% 80%, rgba(255,255,255,.35) 50%, transparent 55%);
      opacity:.35;
      filter: blur(.2px);
      animation: drift 26s linear infinite;
      pointer-events:none;
      transform: translate3d(0,0,0);
    }
    .stars:after{opacity:.18; animation-duration: 40s; transform: translate3d(-20px,10px,0)}
    @keyframes drift{
      from{transform: translate3d(0,0,0)}
      to{transform: translate3d(80px,40px,0)}
    }

    header{
      max-width: 980px;
      margin: 42px auto 0;
      padding: 0 18px;
    }
    .brand{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom: 18px;
    }
    .logo{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .mark{
      width:44px;height:44px;
      border-radius: 14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 45%),
        radial-gradient(circle at 70% 70%, rgba(45,226,230,.18), transparent 55%),
        linear-gradient(135deg, rgba(140,115,255,.45), rgba(45,226,230,.25));
      border: 1px solid var(--stroke);
      box-shadow: 0 0 0 6px rgba(140,115,255,.10), 0 18px 60px rgba(140,115,255,.16);
    }
    h1{
      font-size: clamp(22px, 3.6vw, 34px);
      margin:0;
      letter-spacing: .4px;
    }
    .tag{
      color:var(--muted);
      font-size: 14px;
      margin-top: 2px;
    }
    .pill{
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      padding: 8px 10px;
      border-radius: 999px;
      white-space:nowrap;
      transition: box-shadow .25s ease, border-color .25s ease;
    }

    main{
      max-width: 980px;
      margin: 18px auto 60px;
      padding: 0 18px;
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap: 18px;
    }
    @media (max-width: 860px){
      main{grid-template-columns:1fr}
    }
    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(10px);
    }

    .playerTop{
      .playerTop{
  align-items:center;
}

      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 14px;
      margin-bottom: 12px;
    }
    .now{
      .now{
  flex: 1 1 auto;
  min-width: 0;
}

      display:flex;
      flex-direction:column;
      gap: 6px;
      min-width: 0;
    }
    .now .label{
      color: var(--muted);
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
    }
    .now .title{
      font-size: 18px;
      font-weight: 650;
      line-height: 1.2;
      margin:0;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .artist{
      color: var(--muted);
      font-size: 14px;
      margin: 0;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

   /* Desktop: keep buttons in one line */
.controls{
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:flex-end;
  flex-shrink: 0;
  flex-wrap: nowrap;
}

/* Mobile: let buttons wrap so the title area stays wider */
@media (max-width: 860px){
  .controls{
    flex-wrap: wrap;
    justify-content: flex-start;
  }
}


    button{
      appearance:none;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: var(--ink);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:600;
    }
    button:hover{border-color: rgba(255,255,255,.28); background: rgba(255,255,255,.09)}
    .accent{
      border-color: rgba(140,115,255,.55);
      background: rgba(140,115,255,.18);
      box-shadow: 0 0 0 6px rgba(140,115,255,.10);
    }

    .muted{color:var(--muted); font-size: 13px; line-height:1.45}
    .small{font-size:12px;color:var(--muted)}
    a{color: var(--accent2); text-decoration:none}
    a:hover{text-decoration:underline}

    .list{display:flex; flex-direction:column; gap:10px;}
    .item{
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
    }
    .item b{display:block; margin-bottom: 4px}

    .backup{
      margin-top: 12px;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      display:none;
    }
    .backup.show{display:block}

    .artWrap{
  margin-top: 10px;
  width: 88px;
  height: 88px;
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.18);
  box-shadow: 0 18px 60px rgba(0,0,0,.35);
}
.albumArt{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.albumArt:empty { display:none; }

  </style>
</head>

<body class="stars">
  <header>
    <div class="brand">
      <div class="logo">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1>Carbon Radio</h1>
          <div class="tag">Live transmission • late-night work fuel</div>
        </div>
      </div>
      <div class="pill" id="pillText">checking signal…</div>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="playerTop">
        <div class="now">
          <div class="label">Now Playing</div>
          <p class="title" id="trackTitle">—</p>
          <p class="artist" id="trackArtist">—</p>
          <div class="small" id="statusLine">Checking signal…</div>
              <div class="artWrap">
  <img
    id="albumArt"
    class="albumArt"
    src="https://a7.asurahosting.com/public/carbon_radio/embed.png"
    alt=""
  />
</div>

        </div>

        
       <div class="controls">
          <button class="accent" id="playBtn">▶ Play</button>
          <button id="stopBtn">■ Stop</button>
          <button id="copyBtn">Copy stream URL</button>
        </div>
      </div>

      <audio id="player" preload="none">
  <source src="https://a7.asurahosting.com/listen/carbon_radio/radio.mp3" type="audio/mpeg">
</audio>

       <div class="backup" id="backupBox">
        <b>Metadata offline.</b>
         <div class="muted" style="margin-top:6px">
            Stream is live, but “Now Playing” can’t be reached.
       </div>
      </div>

    </section>

    <aside class="card">
      <div class="list">
        <div class="item">
          <b>About</b>
          <div class="muted">
            A live transmission for focus, late nights, and getting things finished.
            Minimal talk. Maximum continuity.
          </div>
        </div>

        <div class="item">
          <b>Status</b>
          <div class="muted" id="sideStatus">Checking signal…</div>
          <div class="small">Updates every 5 seconds.</div>
        </div>

        <div class="item">
          <b>Links</b>
          <div class="muted">
            <a href="https://a7.asurahosting.com/public/carbon_radio" target="_blank" rel="noopener">Public Player</a>
            &nbsp;•&nbsp;
            <a href="https://a7.asurahosting.com/public/carbon_radio/playlist.m3u" target="_blank" rel="noopener">M3U</a>
            &nbsp;•&nbsp;
            <a href="https://a7.asurahosting.com/public/carbon_radio/playlist.pls" target="_blank" rel="noopener">PLS</a>
          </div>
        </div>

        <div class="item">
          <b>Made under</b>
          <div class="muted">
            <a href="https://wanderingsignalstudios.com" target="_blank" rel="noopener">Wandering Signal Studios</a>
          </div>
        </div>
      </div>
    </aside>
  </main>
  
  <script>
document.addEventListener("DOMContentLoaded", () => {
  // ====== CONFIG ======
  const STREAM_URL = "https://a7.asurahosting.com/listen/carbon_radio/radio.mp3";
  const NOWPLAYING_URL = "https://api.carbonradio.live/nowplaying";
  const POLL_MS = 5000;

  // ====== DOM ======
  const player     = document.getElementById("player");
  const playBtn    = document.getElementById("playBtn");
  const stopBtn    = document.getElementById("stopBtn");
  const copyBtn    = document.getElementById("copyBtn");

  const pillText   = document.getElementById("pillText");
  const trackTitle = document.getElementById("trackTitle");
  const trackArtist= document.getElementById("trackArtist");
  const statusLine = document.getElementById("statusLine");
  const sideStatus = document.getElementById("sideStatus");
  const backupBox  = document.getElementById("backupBox");
  const albumArt   = document.getElementById("albumArt");

  const PLACEHOLDER_ART = "https://a7.asurahosting.com/public/carbon_radio/embed.png";

  function setStatus(msg){
    if (statusLine) statusLine.textContent = msg;
    if (sideStatus) sideStatus.textContent = msg;
  }

  function setPill(text, glow){
    if (!pillText) return;
    pillText.textContent = text;
    pillText.style.boxShadow = glow
      ? "0 0 18px rgba(45,226,230,.55), 0 0 44px rgba(45,226,230,.25)"
      : "none";
    pillText.style.borderColor = glow
      ? "rgba(45,226,230,.45)"
      : "rgba(255,255,255,.14)";
  }

  function showBackup(show){
    if (!backupBox) return;
    backupBox.classList.toggle("show", !!show);
  }

  function setArt(url){
    if (!albumArt) return;
    albumArt.src = url || PLACEHOLDER_ART;
    albumArt.style.opacity = url ? "1" : "0.85";
    albumArt.style.display = "block";
  }

  // ====== AUDIO ======
  playBtn?.addEventListener("click", async () => {
    try{
      // Ensure a source is set even if HTML source tag was removed later
      if (!player.currentSrc) {
        player.src = STREAM_URL;
      }

      if (player.paused){
        await player.play();
        playBtn.textContent = "⏸ Pause";
        setStatus("Broadcasting. You’re tuned in.");
      } else {
        player.pause();
        playBtn.textContent = "▶ Play";
        setStatus("Paused.");
      }
    }catch(e){
      console.log(e);
      setStatus("Couldn’t start the stream.");
    }
  });

  stopBtn?.addEventListener("click", () => {
    player.pause();
    try { player.currentTime = 0; } catch {}
    playBtn.textContent = "▶ Play";
    setStatus("Stopped.");
  });

  copyBtn?.addEventListener("click", async () => {
    try{
      await navigator.clipboard.writeText(STREAM_URL);
      setStatus("Stream URL copied.");
    }catch{
      setStatus("Couldn’t copy stream URL.");
    }
  });

  // ====== NOW PLAYING ======
  async function updateNowPlaying(){
    try{
      const res = await fetch(`${NOWPLAYING_URL}?t=${Date.now()}`, { cache: "no-store" });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);

      const data = await res.json();
      const online = !!data.is_online;

      setPill(online ? "ON AIR" : "OFF AIR", online);

      const song = data?.now_playing?.song || {};
      if (trackTitle) trackTitle.textContent = song.title || song.text || "—";
      if (trackArtist) trackArtist.textContent = song.artist || "—";

      // album art (AzuraCast commonly provides song.art)
      const art = song.art || "";
      setArt(art);

      showBackup(false);
      setStatus(online ? "Live transmission." : "Station offline.");
    }catch(err){
      console.log("NowPlaying error:", err);
      setPill("OFF AIR", false);
      if (trackTitle) trackTitle.textContent = "—";
      if (trackArtist) trackArtist.textContent = "—";
      setArt(""); // fallback art
      showBackup(true);
      setStatus("Metadata unavailable.");
    }
  }

  // Kick it off
  setArt(""); // start with placeholder
  updateNowPlaying();
  setInterval(updateNowPlaying, POLL_MS);
});
</script>
